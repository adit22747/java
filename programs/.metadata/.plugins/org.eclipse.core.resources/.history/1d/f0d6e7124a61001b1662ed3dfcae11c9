package com.cybage.dao;


import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;
import com.cybage.model.Employee;

public class EmployeeDaoImpl implements EmployeeDao {

	

	@Override
	public void add(Employee emp, String type) throws Exception {
//        writer = new FileWriter("db.txt", true);
//        writer.write(emp.toString());
//        writer.close();
		Connection con = DbUtil.getCon();
		
		if(type.equals("REG")) {
			PreparedStatement ps = con.prepareStatement("insert into employee values (?,?,?,?,?)");
			ps.setInt(1, emp.getId());
			ps.setString(2, emp.getName());
			ps.setString(3, emp.getAddress());
			ps.setLong(4, emp.getCompensation());
			ps.setString(5, type);
		}else {
			PreparedStatement ps = con.prepareStatement("insert into employee values (?,?,?,?,?)");
			ps.setInt(1, emp.getId());
			ps.setString(2, emp.getName());
			ps.setString(3, emp.getAddress());
			ps.setLong(4, emp.getCompensation());
			ps.setString(5, type);
		}
		
		result.close();
		statement.close();
		con.close();

	}

	@Override
	public void delete() {
		// TODO Auto-generated method stub

	}

	@Override
	public void update() {
		// TODO Auto-generated method stub

	}

	@Override
	public void display() throws Exception {
		Connection con = DbUtil.getCon();
		// 3. now we can talk to database through con connection
		Statement statement = con.createStatement();
		ResultSet result = statement.executeQuery("select * from customer");
		
		while(result.next()) { //will fetch next record
			System.out.println(result.getInt(1) + "   " + result.getString(2));
		}
		
		
		result.close();
		statement.close();
		con.close();
	}

}
